{"meta":{"title":"Hello_AlexCc","subtitle":"No pains, no gains.","description":"Technology Blog","author":"Hello_AlexCc","url":"http://yoursite.com","root":"/"},"pages":[{"title":"About ME","date":"2022-03-30T02:53:37.000Z","updated":"2022-03-31T02:37:39.820Z","comments":false,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"StoryA long time ago â€¦ A cat is sleepingï¼Œvery very deep sleepingâ€¦ Suddently, He find a mouse â€¦ God damn it, a so cute mouse! He donâ€™t want to eat he, play with he."},{"title":"","date":"2022-11-30T03:01:38.680Z","updated":"2022-11-23T08:23:21.958Z","comments":false,"path":"demo/ObserverMode.html","permalink":"http://yoursite.com/demo/ObserverMode.html","excerpt":"","text":"è§‚å¯Ÿè€…æ¨¡å¼ ul { background-color: antiquewhite; } li { background-color: aqua; margin-top: 12px; } é¢åŒ…å±‘ 1 2 3 // ç›®æ ‡ class Subject { constructor() { this.observers = [] } add(ob) { this.observers.push(ob) } notify(text) { this.observers.forEach(o => { o.update(text) }) } } // è§‚å¯Ÿè€… class Observer { constructor(name) { this.ele = document.querySelector(name) } update(text) { this.ele.innerHTML = text } } const s = new Subject() const o1 = new Observer('.bread') s.add(o1) let oLi = document.querySelectorAll('.left li') for (let i = 0; i < oLi.length; i++) { oLi[i].onclick = function () { s.notify(this.innerHTML) } }"},{"title":"","date":"2022-11-30T03:01:38.694Z","updated":"2022-11-23T12:48:03.716Z","comments":false,"path":"demo/timeFragment.html","permalink":"http://yoursite.com/demo/timeFragment.html","excerpt":"","text":"æ—¶é—´åˆ†ç‰‡ // è®°å½•ä»»åŠ¡å¼€å§‹æ—¶é—´ let now = Date.now(); // æ’å…¥åä¸‡æ¡æ•°æ® const total = 100000; // è·å–å®¹å™¨ let ul = document.getElementById('container'); // å°†æ•°æ®æ’å…¥å®¹å™¨ä¸­ for (let i = 0; i < total; i++) { let li = document.createElement('li'); li.innerText = i ul.appendChild(li); } console.log('JSè¿è¡Œæ—¶é—´ï¼š', Date.now() - now); setTimeout(() => { console.log('æ€»è¿è¡Œæ—¶é—´ï¼š', Date.now() - now); }, 0) // // --------- åˆ†æ‰¹æ¸²æŸ“ --------- // //éœ€è¦æ’å…¥çš„å®¹å™¨ // let ul = document.getElementById('container'); // // æ’å…¥åä¸‡æ¡æ•°æ® // let total = 100000; // // ä¸€æ¬¡æ’å…¥ 20 æ¡ // let once = 20; // //æ€»é¡µæ•° // let page = total / once // //æ¯æ¡è®°å½•çš„ç´¢å¼• // let index = 0; // //å¾ªç¯åŠ è½½æ•°æ® // function loop(curTotal, curIndex) { // if (curTotal { // for (let i = 0; i < pageCount; i++) { // let li = document.createElement('li'); // li.innerText = curIndex + i + ' : ' + ~~(Math.random() * total) // ul.appendChild(li) // } // loop(curTotal - pageCount, curIndex + pageCount) // }, 0) // } // loop(total, index);"},{"title":"","date":"2022-11-30T03:05:16.656Z","updated":"2022-11-30T03:05:16.656Z","comments":false,"path":"demo/resizeObserver.html","permalink":"http://yoursite.com/demo/resizeObserver.html","excerpt":"","text":"Resize observer text test html { height: 100%; font-family: 'helvetica neue', arial, sans-serif; } body { height: inherit; margin: 0; display: flex; justify-content: center; align-items: center; } body>div { background-color: #eee; border: 1px solid #ccc; padding: 20px; width: 50%; min-width: 320px; } h1 { margin: 0; } p { line-height: 1.5; } form { width: 100%; } form>div { display: flex; } form label { flex: 2; } form input { flex: 3; } input[type=\"checkbox\"] { height: 2rem; } So what happened? https://developer.mozilla.org/zh-CN/docs/Web/API/ResizeObserver è®°ä½ï¼Œä¸è¦åšä»»ä½•å½±å“ä»»ä½•äº‹æƒ…çš„äº‹æƒ…ï¼Œé™¤éäº‹å®è¯æ˜ä½ åº”è¯¥è¿™ä¹ˆåšï¼Œé‚£æ ·çš„è¯ï¼Œçœ‹åœ¨ä¸Šå¸çš„ä»½ä¸Šï¼Œä¸è¦ä¸åšï¼æˆ‘çš„çµé­‚ï¼æˆ‘ä¸æƒ³è¢«æ•‘ã€‚ä½ ä»¬ä¸æ˜¯åœ£è¯è€äººï¼ä½ ä»¬éƒ½ä¸æ˜¯æœºå™¨äººã€‚æˆ‘å¾—æƒ³åŠæ³•é€ƒç¦»å¹´è½»æ—¶å¯æ€•çš„æ‘§æ®‹ã€‚çªç„¶é—´ï¼Œæˆ‘æ¯ä¸‰ä¸ªå°æ—¶å°±è¦ä¸Šä¸€æ¬¡å•æ‰€ã€‚ç¤¾ä¿å±€çš„é‚£äº›æ··è›‹ä¹Ÿä¸å†ç»™æˆ‘å¯„æ”¯ç¥¨äº†ã€‚ç°åœ¨æˆ‘å¾—ä»˜é’±ç»™ä»–ä»¬ï¼ Observer enabled: Adjust width: if (window.ResizeObserver) { const h1Elem = document.querySelector('h1'); const pElem = document.querySelector('p'); const divElem = document.querySelector('body > div'); const slider = document.querySelector('input[type=\"range\"]'); const checkbox = document.querySelector('input[type=\"checkbox\"]'); divElem.style.width = '600px'; slider.addEventListener('input', () => { divElem.style.width = slider.value + 'px'; }) const resizeObserver = new ResizeObserver(entries => { console.log('entries', entries) for (let entry of entries) { if (entry.contentBoxSize) { // The standard makes contentBoxSize an array... if (entry.contentBoxSize[0]) { h1Elem.style.fontSize = Math.max(1.5, entry.contentBoxSize[0].inlineSize / 200) + 'rem'; pElem.style.fontSize = Math.max(1, entry.contentBoxSize[0].inlineSize / 600) + 'rem'; } else { // ...but old versions of Firefox treat it as a single item h1Elem.style.fontSize = Math.max(1.5, entry.contentBoxSize.inlineSize / 200) + 'rem'; pElem.style.fontSize = Math.max(1, entry.contentBoxSize.inlineSize / 600) + 'rem'; } } else { h1Elem.style.fontSize = Math.max(1.5, entry.contentRect.width / 200) + 'rem'; pElem.style.fontSize = Math.max(1, entry.contentRect.width / 600) + 'rem'; } } console.log('Size changed'); }); resizeObserver.observe(divElem); checkbox.addEventListener('change', () => { if (checkbox.checked) { resizeObserver.observe(divElem); } else { resizeObserver.unobserve(divElem); } }); } else { console.log('Resize observer not supported!'); }"},{"title":"","date":"2022-11-30T03:01:38.689Z","updated":"2022-11-23T09:03:02.974Z","comments":false,"path":"demo/PubSubMode.html","permalink":"http://yoursite.com/demo/PubSubMode.html","excerpt":"","text":"å‘å¸ƒè®¢é˜…è€…æ¨¡å¼ ul { background-color: antiquewhite; } li { background-color: aqua; margin-top: 12px; } é¢åŒ…å±‘ 1 2 3 const PubSub = { message: {}, // å°†äº‹ä»¶å­˜å‚¨æ•°ç»„ï¼Œæ”¹æˆå¯¹è±¡ï¼Œkey è¡¨ç¤ºäº‹ä»¶ç±»å‹ï¼Œvalue è¡¨ç¤ºè®¢é˜…çš„äº‹ä»¶æ•°ç»„ publist(type, text) { if (!this.message[type]) return this.message[type].forEach(cb => { cb(text) }) }, subscribe(type, cb) { if (!this.message[type]) { this.message[type] = [cb] // å¦‚æœäº‹ä»¶ type ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°±åˆ›å»ºä¸€ä¸ªäº‹ä»¶ç±»å‹æ•°ç»„ } else { this.message[type].push(cb) } }, unsubscribe(type, cb) { // å–æ¶ˆè®¢é˜… if (!this.message[type]) return if (!cb) { // å–æ¶ˆæ‰€æœ‰è®¢é˜…çš„äº‹ä»¶ this.message[type] = [] } else { this.message[type] = this.message[type].filter(i => i !== cb) } } } PubSub.subscribe('updateBread', function (text) { const breadEle = document.querySelector('.bread') breadEle.innerHTML = text }) let oLi = document.querySelectorAll('.left li') for (let i = 0; i < oLi.length; i++) { oLi[i].onclick = function () { PubSub.publist('updateBread', this.innerHTML) } }"}],"posts":[{"title":"é«˜æ€§èƒ½æ¸²æŸ“åä¸‡æ¡æ•°æ®(è™šæ‹Ÿåˆ—è¡¨)","slug":"virtual-list","date":"2022-11-23T12:43:13.000Z","updated":"2022-11-28T03:19:11.257Z","comments":true,"path":"/post/virtual-list.html","link":"","permalink":"http://yoursite.com/post/virtual-list.html","excerpt":"ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨çš„æ–¹å¼ï¼Œæ¥åŒæ—¶åŠ è½½å¤§é‡æ•°æ®ã€‚","text":"å‰è¨€åœ¨å·¥ä½œä¸­ï¼Œæœ‰æ—¶ä¼šé‡åˆ°éœ€è¦ä¸€äº›ä¸èƒ½ä½¿ç”¨åˆ†é¡µæ–¹å¼æ¥åŠ è½½åˆ—è¡¨æ•°æ®çš„ä¸šåŠ¡æƒ…å†µï¼Œå¯¹äºæ­¤ï¼Œæˆ‘ä»¬ç§°è¿™ç§åˆ—è¡¨å«åšé•¿åˆ—è¡¨ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€äº›å¤–æ±‡äº¤æ˜“ç³»ç»Ÿä¸­ï¼Œå‰ç«¯ä¼šå®æ—¶çš„å±•ç¤ºç”¨æˆ·çš„æŒä»“æƒ…å†µ(æ”¶ç›Šã€äºæŸã€æ‰‹æ•°ç­‰)ï¼Œæ­¤æ—¶å¯¹äºç”¨æˆ·çš„æŒä»“åˆ—è¡¨ä¸€èˆ¬æ˜¯ä¸èƒ½åˆ†é¡µçš„ã€‚ æ—¶é—´åˆ†ç‰‡ æåˆ°äº†å¯ä»¥ä½¿ç”¨æ—¶é—´åˆ†ç‰‡çš„æ–¹å¼æ¥å¯¹é•¿åˆ—è¡¨è¿›è¡Œæ¸²æŸ“ï¼Œä½†è¿™ç§æ–¹å¼æ›´é€‚ç”¨äºåˆ—è¡¨é¡¹çš„DOMç»“æ„ååˆ†ç®€å•çš„æƒ…å†µã€‚æœ¬æ–‡ä¼šä»‹ç»ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨çš„æ–¹å¼ï¼Œæ¥åŒæ—¶åŠ è½½å¤§é‡æ•°æ®ã€‚ å½“æˆ‘ä»¬æ¸²æŸ“10wæ¡æ•°æ®æ—¶ï¼Œå…¶å®ä¸»è¦æ˜¯çš„æ—¶é—´èŠ±è´¹åœ¨ Recalculate Style å’Œ Layout ä¸Š Recalculate Styleï¼šæ ·å¼è®¡ç®—ï¼Œæµè§ˆå™¨æ ¹æ®cssé€‰æ‹©å™¨è®¡ç®—å“ªäº›å…ƒç´ åº”è¯¥åº”ç”¨å“ªäº›è§„åˆ™ï¼Œç¡®å®šæ¯ä¸ªå…ƒç´ å…·ä½“çš„æ ·å¼ã€‚ Layoutï¼šå¸ƒå±€ï¼ŒçŸ¥é“å…ƒç´ åº”ç”¨å“ªäº›è§„åˆ™ä¹‹åï¼Œæµè§ˆå™¨å¼€å§‹è®¡ç®—å®ƒè¦å æ®çš„ç©ºé—´å¤§å°åŠå…¶åœ¨å±å¹•çš„ä½ç½®ã€‚ åœ¨å®é™…çš„å·¥ä½œä¸­ï¼Œåˆ—è¡¨é¡¹å¿…ç„¶ä¸ä¼šåƒä¾‹å­ä¸­ä»…ä»…åªç”±ä¸€ä¸ªliæ ‡ç­¾ç»„æˆï¼Œå¿…ç„¶æ˜¯ç”±å¤æ‚DOMèŠ‚ç‚¹ç»„æˆçš„ã€‚ é‚£ä¹ˆå¯ä»¥æƒ³è±¡çš„æ˜¯ï¼Œå½“åˆ—è¡¨é¡¹æ•°è¿‡å¤šå¹¶ä¸”åˆ—è¡¨é¡¹ç»“æ„å¤æ‚çš„æ—¶å€™ï¼ŒåŒæ—¶æ¸²æŸ“æ—¶ï¼Œä¼šåœ¨Recalculate Styleå’ŒLayouté˜¶æ®µæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚ è€Œè™šæ‹Ÿåˆ—è¡¨å°±æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„ä¸€ç§å®ç°ã€‚ ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨è™šæ‹Ÿåˆ—è¡¨å…¶å®æ˜¯æŒ‰éœ€æ˜¾ç¤ºçš„ä¸€ç§å®ç°ï¼Œå³åªå¯¹å¯è§åŒºåŸŸè¿›è¡Œæ¸²æŸ“ï¼Œå¯¹éå¯è§åŒºåŸŸä¸­çš„æ•°æ®ä¸æ¸²æŸ“æˆ–éƒ¨åˆ†æ¸²æŸ“çš„æŠ€æœ¯ï¼Œä»è€Œè¾¾åˆ°æé«˜çš„æ¸²æŸ“æ€§èƒ½ã€‚ å‡è®¾æœ‰1ä¸‡æ¡è®°å½•éœ€è¦åŒæ—¶æ¸²æŸ“ï¼Œæˆ‘ä»¬å±å¹•çš„å¯è§åŒºåŸŸçš„é«˜åº¦ä¸º1000px,è€Œåˆ—è¡¨é¡¹çš„é«˜åº¦ä¸º50pxï¼Œåˆ™æ­¤æ—¶æˆ‘ä»¬åœ¨å±å¹•ä¸­æœ€å¤šåªèƒ½çœ‹åˆ°20ä¸ªåˆ—è¡¨é¡¹ï¼Œé‚£ä¹ˆåœ¨é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€åŠ è½½20æ¡å³å¯ã€‚ è¯´å®Œé¦–æ¬¡åŠ è½½ï¼Œå†åˆ†æä¸€ä¸‹å½“æ»šåŠ¨å‘ç”Ÿæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—å½“å‰æ»šåŠ¨å€¼å¾—çŸ¥æ­¤æ—¶åœ¨å±å¹•å¯è§åŒºåŸŸåº”è¯¥æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹ã€‚ å‡è®¾æ»šåŠ¨å‘ç”Ÿï¼Œæ»šåŠ¨æ¡è·é¡¶éƒ¨çš„ä½ç½®ä¸º150px,åˆ™æˆ‘ä»¬å¯å¾—çŸ¥åœ¨å¯è§åŒºåŸŸå†…çš„åˆ—è¡¨é¡¹ä¸ºç¬¬4é¡¹è‡³`ç¬¬13é¡¹ã€‚ å®ç°è™šæ‹Ÿåˆ—è¡¨çš„å®ç°ï¼Œå®é™…ä¸Šæ˜¯åœ¨é¦–å±åŠ è½½çš„æ—¶å€™ï¼ŒåªåŠ è½½ å¯è§†åŒºåŸŸ å†…éœ€è¦çš„åˆ—è¡¨é¡¹ï¼Œå½“æ»šåŠ¨å‘ç”Ÿæ—¶ï¼Œé€šè¿‡è®¡ç®—åŠ¨æ€è·å¾—å¯è§†åŒºåŸŸå†…çš„åˆ—è¡¨é¡¹ï¼Œå¹¶å°†éå¯è§†åŒºåŸŸå†…å­˜åœ¨çš„åˆ—è¡¨é¡¹åˆ é™¤ã€‚ è®¡ç®—å½“å‰å¯è§†åŒºåŸŸèµ·å§‹æ•°æ®ç´¢å¼•ï¼ˆstartIndexï¼‰ è®¡ç®—å½“å‰å¯è§†åŒºåŸŸç»“æŸæ•°æ®ç´¢å¼•ï¼ˆendIndexï¼‰ è®¡ç®—å½“å‰å¯è§†åŒºåŸŸçš„æ•°æ®ï¼Œå¹¶æ¸²æŸ“åˆ°é¡µé¢ä¸­ è®¡ç®—startIndexå¯¹åº”çš„æ•°æ®åœ¨æ•´ä¸ªåˆ—è¡¨ä¸­çš„åç§»ä½ç½®startOffsetå¹¶è®¾ç½®åˆ°åˆ—è¡¨ä¸Š ç”±äºåªæ˜¯å¯¹å¯è§†åŒºåŸŸå†…çš„åˆ—è¡¨é¡¹è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ºäº†ä¿æŒåˆ—è¡¨å®¹å™¨çš„é«˜åº¦å¹¶å¯æ­£å¸¸çš„è§¦å‘æ»šåŠ¨ï¼Œå°†Htmlç»“æ„è®¾è®¡æˆå¦‚ä¸‹ç»“æ„ï¼š 1234567891011121314151617181920&lt;div ref=&quot;list&quot; class=&quot;infinite-list-container&quot; @scroll=&quot;scrollEvent($event)&quot;&gt; &lt;!-- æ‰€æœ‰æ•°æ®çš„æ€»é«˜åº¦ --&gt; &lt;div class=&quot;infinite-list-phantom&quot; :style=&quot;&#123; height: listHeight + &#x27;px&#x27; &#125;&quot;&gt;&lt;/div&gt; &lt;!-- å¯è§†åŒºåŒºåŸŸï¼Œå¯ä»¥å½“åšæ»‘å—çœ‹å¾… --&gt; &lt;div class=&quot;infinite-list&quot; :style=&quot;&#123; transform: getTransform &#125;&quot;&gt; &lt;!-- æ¯ä¸€é¡¹æ•°æ® --&gt; &lt;div ref=&quot;items&quot; class=&quot;infinite-list-item&quot; v-for=&quot;item in visibleData&quot; :key=&quot;item.id&quot; :style=&quot;&#123; height: itemSize + &#x27;px&#x27;, lineHeight: itemSize + &#x27;px&#x27; &#125;&quot; &gt; &#123;&#123; item.value &#125;&#125; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; æ¥ç€ï¼Œç›‘å¬infinite-list-containerçš„ scrolläº‹ä»¶ï¼Œè·å–æ»šåŠ¨ä½ç½® scrollTopã€‚ åˆ—è¡¨æ€»é«˜åº¦ listHeight = listData.length * itemSize å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•° visibleCount = Math.ceil(screenHeight / itemSize) æ•°æ®çš„èµ·å§‹ç´¢å¼• startIndex = Math.floor(scrollTop / itemSize) æ•°æ®çš„ç»“æŸç´¢å¼• endIndex = startIndex + visibleCount åˆ—è¡¨æ˜¾ç¤ºæ•°æ®ä¸º visibleData = listData.slice(startIndex,endIndex) 12345678910111213scrollEvent() &#123; //å½“å‰æ»šåŠ¨ä½ç½® let scrollTop = this.$refs.list.scrollTop; //æ­¤æ—¶çš„å¼€å§‹ç´¢å¼•ï¼ˆå‘ä¸‹å–æ•´ï¼‰ï¼ŒitemSize æ˜¯ 100 this.start = Math.floor(scrollTop / this.itemSize); //æ­¤æ—¶çš„ç»“æŸç´¢å¼• this.end = this.start + this.visibleCount; //æ­¤æ—¶çš„åç§»é‡ this.startOffset = scrollTop - (scrollTop % this.itemSize);&#125;, å½“æ»šåŠ¨åï¼Œç”±äº æ¸²æŸ“åŒºåŸŸ ç›¸å¯¹äº å¯è§†åŒºåŸŸ å·²ç»å‘ç”Ÿäº†åç§»ï¼Œæ­¤æ—¶æˆ‘éœ€è¦è·å–ä¸€ä¸ª åç§»é‡startOffsetï¼Œé€šè¿‡æ ·å¼æ§åˆ¶å°†æ¸²æŸ“åŒºåŸŸåç§»è‡³å¯è§†åŒºåŸŸä¸­ï¼Œå½“ç”¨æˆ·åœ¨æ»‘åŠ¨æ—¶ï¼Œæ¸²æŸ“åŒºåŸŸå°±ä¼šæ ¹æ® startOffset è®¡ç®—å‡ºåç§»é‡ï¼Œæ¸²æŸ“åŒºåŸŸå°±ä¼šä¸€ç›´åœ¨å¯è§†åŒºåŸŸå†…å‘ˆç°ã€‚ 1234567this.startOffset = scrollTop - (scrollTop % this.itemSize);// computed//åç§»é‡å¯¹åº”çš„stylegetTransform() &#123; return `translate3d(0,$&#123;this.startOffset&#125;px,0)`;&#125;, å®Œæ•´ä»£ç 12345678910111213141516&lt;style&gt; html&#123; height: 100%; &#125; body&#123; height: 100%; margin:0; &#125; #app&#123; height:100%; &#125;&lt;/style&gt;&lt;div id=&quot;app&quot;&gt; &lt;VirtualList :listData=&quot;state.data&quot; :itemSize=&quot;100&quot; /&gt;&lt;/div&gt; VirtualList comp. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125&lt;script&gt;export default &#123; name: &quot;VirtualList&quot;, props: &#123; //æ‰€æœ‰åˆ—è¡¨æ•°æ® listData: &#123; type: Array, default: () =&gt; [], &#125;, //æ¯é¡¹é«˜åº¦ itemSize: &#123; type: Number, default: 200, &#125;, &#125;, computed: &#123; //åˆ—è¡¨æ€»é«˜åº¦ listHeight() &#123; return this.listData.length * this.itemSize; &#125;, //å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•° visibleCount() &#123; // å‘ä¸Šå–æ•´: Math.ceil(13.06) =&gt; 14ï¼Œè¡¨ç¤ºæ•´ä¸ªå±å¹•ï¼Œå¯ä»¥æ”¾ 14 æ¡æ•°æ® return Math.ceil(this.screenHeight / this.itemSize); &#125;, //åç§»é‡å¯¹åº”çš„style getTransform() &#123; return `translate3d(0,$&#123;this.startOffset&#125;px,0)`; &#125;, //è·å–çœŸå®æ˜¾ç¤ºåˆ—è¡¨æ•°æ® visibleData() &#123; return this.listData.slice( this.start, Math.min(this.end, this.listData.length) ); &#125;, &#125;, mounted() &#123; // this.$el è¡¨ç¤ºå½“å‰ç»„ä»¶çš„æ ¹èŠ‚ç‚¹ï¼Œè¿™é‡Œæ˜¯ infinite-list-container this.screenHeight = this.$el.clientHeight; this.start = 0; this.end = this.start + this.visibleCount; &#125;, data() &#123; return &#123; //å¯è§†åŒºåŸŸé«˜åº¦ screenHeight: 0, //åç§»é‡ startOffset: 0, //èµ·å§‹ç´¢å¼• start: 0, //ç»“æŸç´¢å¼• end: null, &#125;; &#125;, methods: &#123; scrollEvent() &#123; //å½“å‰æ»šåŠ¨ä½ç½® let scrollTop = this.$refs.list.scrollTop; //æ­¤æ—¶çš„å¼€å§‹ç´¢å¼•ï¼ˆå‘ä¸‹å–æ•´ï¼‰ï¼ŒitemSize æ˜¯ 100 this.start = Math.floor(scrollTop / this.itemSize); //æ­¤æ—¶çš„ç»“æŸç´¢å¼• this.end = this.start + this.visibleCount; //æ­¤æ—¶çš„åç§»é‡ this.startOffset = scrollTop - (scrollTop % this.itemSize); &#125;, &#125;,&#125;;&lt;/script&gt;&lt;template&gt; &lt;div ref=&quot;list&quot; class=&quot;infinite-list-container&quot; @scroll=&quot;scrollEvent($event)&quot;&gt; &lt;!-- æ‰€æœ‰æ•°æ®çš„æ€»é«˜åº¦ --&gt; &lt;div class=&quot;infinite-list-phantom&quot; :style=&quot;&#123; height: listHeight + &#x27;px&#x27; &#125;&quot;&gt;&lt;/div&gt; &lt;!-- å¯è§†åŒºåŒºåŸŸï¼Œå¯ä»¥å½“åšæ»‘å—çœ‹å¾… --&gt; &lt;div class=&quot;infinite-list&quot; :style=&quot;&#123; transform: getTransform &#125;&quot;&gt; &lt;div ref=&quot;items&quot; class=&quot;infinite-list-item&quot; v-for=&quot;item in visibleData&quot; :key=&quot;item.id&quot; :style=&quot;&#123; height: itemSize + &#x27;px&#x27;, lineHeight: itemSize + &#x27;px&#x27; &#125;&quot; &gt; &#123;&#123; item.value &#125;&#125; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.infinite-list-container &#123; height: 100%; overflow: auto; position: relative; -webkit-overflow-scrolling: touch;&#125;.infinite-list-phantom &#123; position: absolute; left: 0; top: 0; right: 0; z-index: -1;&#125;.infinite-list &#123; left: 0; right: 0; top: 0; position: absolute; text-align: center;&#125;.infinite-list-item &#123; padding: 10px; color: #555; box-sizing: border-box; border-bottom: 1px solid #999;&#125;&lt;/style&gt; åˆ—è¡¨é¡¹åŠ¨æ€é«˜åº¦åœ¨ä¹‹å‰çš„å®ç°ä¸­ï¼Œåˆ—è¡¨é¡¹çš„é«˜åº¦æ˜¯å›ºå®šçš„ï¼Œå› ä¸ºé«˜åº¦å›ºå®šï¼Œæ‰€ä»¥å¯ä»¥å¾ˆè½»æ˜“çš„è·å–åˆ—è¡¨é¡¹çš„æ•´ä½“é«˜åº¦ä»¥åŠæ»šåŠ¨æ—¶çš„æ˜¾ç¤ºæ•°æ®ä¸å¯¹åº”çš„åç§»é‡ã€‚ è€Œå®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå½“åˆ—è¡¨ä¸­åŒ…å«æ–‡æœ¬ä¹‹ç±»çš„å¯å˜å†…å®¹ï¼Œä¼šå¯¼è‡´ åˆ—è¡¨é¡¹çš„é«˜åº¦å¹¶ä¸ç›¸åŒã€‚ æ¯”å¦‚è¿™æ ·ï¼š åœ¨è™šæ‹Ÿåˆ—è¡¨ä¸­åº”ç”¨åŠ¨æ€é«˜åº¦çš„è§£å†³æ–¹æ¡ˆä¸€èˆ¬æœ‰å¦‚ä¸‹ä¸‰ç§ï¼š 1.å¯¹ç»„ä»¶å±æ€§itemSizeè¿›è¡Œæ‰©å±•ï¼Œæ”¯æŒä¼ é€’ç±»å‹ä¸ºæ•°å­—ã€æ•°ç»„ã€å‡½æ•° å¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼Œå¦‚ 100ï¼Œæ­¤æ—¶åˆ—è¡¨é¡¹æ˜¯å›ºé«˜çš„ å¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰åˆ—è¡¨é¡¹é«˜åº¦çš„æ•°æ®ï¼Œå¦‚ [50, 20, 100, 80, â€¦] å¯ä»¥æ˜¯ä¸€ä¸ªæ ¹æ®åˆ—è¡¨é¡¹ç´¢å¼•è¿”å›å…¶é«˜åº¦çš„å‡½æ•°ï¼š(index: number): number è¿™ç§æ–¹å¼è™½ç„¶æœ‰æ¯”è¾ƒå¥½çš„çµæ´»åº¦ï¼Œä½†ä»…é€‚ç”¨äºå¯ä»¥é¢„å…ˆçŸ¥é“æˆ–å¯ä»¥é€šè¿‡è®¡ç®—å¾—çŸ¥åˆ—è¡¨é¡¹é«˜åº¦çš„æƒ…å†µï¼Œä¾ç„¶æ— æ³•è§£å†³åˆ—è¡¨é¡¹é«˜åº¦ç”±å†…å®¹æ’‘å¼€çš„æƒ…å†µã€‚ 2.å°†åˆ—è¡¨é¡¹ æ¸²æŸ“åˆ°å±å¹•å¤–ï¼Œå¯¹å…¶é«˜åº¦è¿›è¡Œæµ‹é‡å¹¶ç¼“å­˜ï¼Œç„¶åå†å°†å…¶æ¸²æŸ“è‡³å¯è§†åŒºåŸŸå†…ã€‚ ç”±äº é¢„å…ˆæ¸²æŸ“è‡³å±å¹•å¤–ï¼Œå†æ¸²æŸ“è‡³å±å¹•å†…ï¼Œè¿™å¯¼è‡´æ¸²æŸ“æˆæœ¬å¢åŠ ä¸€å€ï¼Œè¿™å¯¹äºæ•°ç™¾ä¸‡ç”¨æˆ·åœ¨ä½ç«¯ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨çš„äº§å“æ¥è¯´æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ 3.ä»¥é¢„ä¼°é«˜åº¦å…ˆè¡Œæ¸²æŸ“ï¼Œç„¶åè·å–çœŸå®é«˜åº¦å¹¶ç¼“å­˜ã€‚ è¿™æ˜¯å¯ä»¥é€‰æ‹©çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é¿å…å‰ä¸¤ç§æ–¹æ¡ˆçš„ä¸è¶³ã€‚","categories":[],"tags":[{"name":"JS","slug":"JS","permalink":"http://yoursite.com/tags/JS/"}]},{"title":"é«˜æ€§èƒ½æ¸²æŸ“åä¸‡æ¡æ•°æ®(æ—¶é—´åˆ†ç‰‡)","slug":"time-fragment","date":"2022-11-23T11:53:52.000Z","updated":"2022-11-23T12:52:27.198Z","comments":true,"path":"/post/time-fragment.html","link":"","permalink":"http://yoursite.com/post/time-fragment.html","excerpt":"æ¸²æŸ“å¤§é‡æ•°æ®ã€‚","text":"æœ€ç²—æš´çš„åšæ³•ï¼ˆä¸€æ¬¡æ€§æ¸²æŸ“JSçš„è¿è¡Œæ—¶é—´ä¸º187msï¼Œè¿˜æ˜¯è›®å¿«çš„ï¼Œä½†æ˜¯æœ€ç»ˆæ¸²æŸ“å®Œæˆåçš„æ€»æ—¶é—´ç¡®æ˜¯2844msï¼Œä¸­é—´ä¼šç™½å±ä¸€æ®µæ—¶é—´ã€‚ 1234567891011121314151617// è®°å½•ä»»åŠ¡å¼€å§‹æ—¶é—´let now = Date.now();// æ’å…¥åä¸‡æ¡æ•°æ®const total = 100000;// è·å–å®¹å™¨let ul = document.getElementById(&#x27;container&#x27;);// å°†æ•°æ®æ’å…¥å®¹å™¨ä¸­for (let i = 0; i &lt; total; i++) &#123; let li = document.createElement(&#x27;li&#x27;); li.innerText = i ul.appendChild(li);&#125;console.log(&#x27;JSè¿è¡Œæ—¶é—´ï¼š&#x27;, Date.now() - now);setTimeout(() =&gt; &#123; console.log(&#x27;æ€»è¿è¡Œæ—¶é—´ï¼š&#x27;, Date.now() - now);&#125;, 0) ä½¿ç”¨å®šæ—¶å™¨é¡µé¢çš„å¡é¡¿æ˜¯ç”±äºåŒæ—¶æ¸²æŸ“å¤§é‡DOMæ‰€å¼•èµ·çš„ï¼Œæ‰€ä»¥è€ƒè™‘å°†æ¸²æŸ“è¿‡ç¨‹åˆ†æ‰¹è¿›è¡Œï¼Œè¿™é‡Œç”¨åˆ°çš„å°±æ˜¯ setTimeoutã€‚ 1234567891011121314151617181920212223242526let ul = document.getElementById(&#x27;container&#x27;);// æ’å…¥åä¸‡æ¡æ•°æ®let total = 100000;// ä¸€æ¬¡æ’å…¥ 20 æ¡let once = 20;//æ€»é¡µæ•°let page = total / once//æ¯æ¡è®°å½•çš„ç´¢å¼•let index = 0;//å¾ªç¯åŠ è½½æ•°æ®function loop(curTotal, curIndex) &#123; if (curTotal &lt;= 0) &#123; return false; &#125; //æ¯é¡µå¤šå°‘æ¡ let pageCount = Math.min(curTotal, once); setTimeout(() =&gt; &#123; for (let i = 0; i &lt; pageCount; i++) &#123; let li = document.createElement(&#x27;li&#x27;); li.innerText = curIndex + i + &#x27; : &#x27; + ~~(Math.random() * total) ul.appendChild(li) &#125; loop(curTotal - pageCount, curIndex + pageCount) &#125;, 0)&#125;loop(total, index); é¡µé¢åŠ è½½çš„æ—¶é—´å·²ç»éå¸¸å¿«äº†ï¼Œæ¯æ¬¡åˆ·æ–°æ—¶å¯ä»¥å¾ˆå¿«çš„çœ‹åˆ°ç¬¬ä¸€å±çš„æ‰€æœ‰æ•°æ®ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å¿«é€Ÿæ»šåŠ¨é¡µé¢çš„æ—¶å€™ï¼Œä¼šå‘ç°é¡µé¢å‡ºç°é—ªå±æˆ–ç™½å±çš„ç°è±¡ã€‚ ä¸ºä»€ä¹ˆä¼šå‡ºç°é—ªå±ç°è±¡å‘¢é¦–å…ˆï¼Œç†æ¸…ä¸€äº›æ¦‚å¿µã€‚FPSè¡¨ç¤ºçš„æ˜¯æ¯ç§’é’Ÿç”»é¢æ›´æ–°æ¬¡æ•°ã€‚æˆ‘ä»¬å¹³æ—¶æ‰€çœ‹åˆ°çš„è¿ç»­ç”»é¢éƒ½æ˜¯ç”±ä¸€å¹…å¹…é™æ­¢ç”»é¢ç»„æˆçš„ï¼Œæ¯å¹…ç”»é¢ç§°ä¸ºä¸€å¸§ï¼ŒFPSæ˜¯æè¿°å¸§å˜åŒ–é€Ÿåº¦çš„ç‰©ç†é‡ã€‚ å¤§å¤šæ•°ç”µè„‘æ˜¾ç¤ºå™¨çš„åˆ·æ–°é¢‘ç‡æ˜¯60Hzï¼Œå¤§æ¦‚ç›¸å½“äºæ¯ç§’é’Ÿé‡ç»˜60æ¬¡ï¼ŒFPSä¸º60frame/sï¼Œä¸ºè¿™ä¸ªå€¼çš„è®¾å®šå—å±å¹•åˆ†è¾¨ç‡ã€å±å¹•å°ºå¯¸å’Œæ˜¾å¡çš„å½±å“ã€‚ å› æ­¤ï¼Œå½“ä½ å¯¹ç€ç”µè„‘å±å¹•ä»€ä¹ˆä¹Ÿä¸åšçš„æƒ…å†µä¸‹ï¼Œå¤§å¤šæ˜¾ç¤ºå™¨ä¹Ÿä¼šä»¥æ¯ç§’60æ¬¡çš„é¢‘ç‡æ­£åœ¨ä¸æ–­çš„æ›´æ–°å±å¹•ä¸Šçš„å›¾åƒã€‚ ä¸ºä»€ä¹ˆä½ æ„Ÿè§‰ä¸åˆ°è¿™ä¸ªå˜åŒ–ï¼Ÿ é‚£æ˜¯å› ä¸ºäººçš„çœ¼ç›æœ‰è§†è§‰åœç•™æ•ˆåº”ï¼Œå³å‰ä¸€å‰¯ç”»é¢ç•™åœ¨å¤§è„‘çš„å°è±¡è¿˜æ²¡æ¶ˆå¤±ï¼Œç´§æ¥ç€åä¸€å‰¯ç”»é¢å°±è·Ÿä¸Šæ¥äº†ï¼Œè¿™ä¸­é—´åªé—´éš”äº†16.7ms(1000/60â‰ˆ16.7)ï¼Œæ‰€ä»¥ä¼šè®©ä½ è¯¯ä»¥ä¸ºå±å¹•ä¸Šçš„å›¾åƒæ˜¯é™æ­¢ä¸åŠ¨çš„ã€‚ è€Œå±å¹•ç»™ä½ çš„è¿™ç§æ„Ÿè§‰æ˜¯å¯¹çš„ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœåˆ·æ–°é¢‘ç‡å˜æˆ1æ¬¡/ç§’ï¼Œå±å¹•ä¸Šçš„å›¾åƒå°±ä¼šå‡ºç°ä¸¥é‡çš„é—ªçƒï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“å¼•èµ·çœ¼ç›ç–²åŠ³ã€é…¸ç—›å’Œå¤´æ™•ç›®çœ©ç­‰ç—‡çŠ¶ã€‚ å¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šå¯¹é‡ç»˜æ“ä½œåŠ ä»¥é™åˆ¶ï¼Œä¸è¶…è¿‡æ˜¾ç¤ºå™¨çš„é‡ç»˜é¢‘ç‡ï¼Œå› ä¸ºå³ä½¿è¶…è¿‡é‚£ä¸ªé¢‘ç‡ç”¨æˆ·ä½“éªŒä¹Ÿä¸ä¼šæœ‰æå‡ã€‚å› æ­¤ï¼Œæœ€å¹³æ»‘åŠ¨ç”»çš„æœ€ä½³å¾ªç¯é—´éš”æ˜¯1000ms/60ï¼Œçº¦ç­‰äº16.6msã€‚ ç›´è§‚æ„Ÿå—ï¼Œä¸åŒå¸§ç‡çš„ä½“éªŒï¼š å¸§ç‡èƒ½å¤Ÿè¾¾åˆ° 50 ï½ 60 FPS çš„åŠ¨ç”»å°†ä¼šç›¸å½“æµç•…ï¼Œè®©äººå€æ„Ÿèˆ’é€‚ï¼› å¸§ç‡åœ¨ 30 ï½ 50 FPS ä¹‹é—´çš„åŠ¨ç”»ï¼Œå› å„äººæ•æ„Ÿç¨‹åº¦ä¸åŒï¼Œèˆ’é€‚åº¦å› äººè€Œå¼‚ï¼› å¸§ç‡åœ¨ 30 FPS ä»¥ä¸‹çš„åŠ¨ç”»ï¼Œè®©äººæ„Ÿè§‰åˆ°æ˜æ˜¾çš„å¡é¡¿å’Œä¸é€‚æ„Ÿï¼› å¸§ç‡æ³¢åŠ¨å¾ˆå¤§çš„åŠ¨ç”»ï¼Œäº¦ä¼šä½¿äººæ„Ÿè§‰åˆ°å¡é¡¿ã€‚ ç®€å•èŠä¸€ä¸‹ setTimeout å’Œé—ªå±ç°è±¡ setTimeoutçš„æ‰§è¡Œæ—¶é—´å¹¶ä¸æ˜¯ç¡®å®šçš„ã€‚åœ¨JSä¸­ï¼ŒsetTimeoutä»»åŠ¡è¢«æ”¾è¿›äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ‰ä¼šå»æ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ˜¯å¦éœ€è¦æ‰§è¡Œï¼Œå› æ­¤setTimeoutçš„å®é™…æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šæ¯”å…¶è®¾å®šçš„æ—¶é—´æ™šä¸€äº›ã€‚ åˆ·æ–°é¢‘ç‡å—å±å¹•åˆ†è¾¨ç‡å’Œå±å¹•å°ºå¯¸çš„å½±å“ï¼Œå› æ­¤ä¸åŒè®¾å¤‡çš„åˆ·æ–°é¢‘ç‡å¯èƒ½ä¼šä¸åŒï¼Œè€ŒsetTimeoutåªèƒ½è®¾ç½®ä¸€ä¸ªå›ºå®šæ—¶é—´é—´éš”ï¼Œè¿™ä¸ªæ—¶é—´ä¸ä¸€å®šå’Œå±å¹•çš„åˆ·æ–°æ—¶é—´ç›¸åŒã€‚ ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½ä¼šå¯¼è‡´setTimeoutçš„æ‰§è¡Œæ­¥è°ƒå’Œå±å¹•çš„åˆ·æ–°æ­¥è°ƒä¸ä¸€è‡´ã€‚ åœ¨setTimeoutä¸­å¯¹domè¿›è¡Œæ“ä½œï¼Œå¿…é¡»è¦ç­‰åˆ°å±å¹•ä¸‹æ¬¡ç»˜åˆ¶æ—¶æ‰èƒ½æ›´æ–°åˆ°å±å¹•ä¸Šï¼Œå¦‚æœä¸¤è€…æ­¥è°ƒä¸ä¸€è‡´ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸­é—´æŸä¸€å¸§çš„æ“ä½œè¢«è·¨è¶Šè¿‡å»ï¼Œè€Œç›´æ¥æ›´æ–°ä¸‹ä¸€å¸§çš„å…ƒç´ ï¼Œä»è€Œå¯¼è‡´ä¸¢å¸§ç°è±¡ã€‚ ä½¿ç”¨ requestAnimationFrameä¸setTimeoutç›¸æ¯”ï¼ŒrequestAnimationFrameæœ€å¤§çš„ä¼˜åŠ¿æ˜¯ç”±ç³»ç»Ÿæ¥å†³å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœºã€‚ å¦‚æœå±å¹•åˆ·æ–°ç‡æ˜¯60Hz,é‚£ä¹ˆå›è°ƒå‡½æ•°å°±æ¯16.7msè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåˆ·æ–°ç‡æ˜¯75Hzï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶é—´é—´éš”å°±å˜æˆäº†1000/75=13.3msï¼Œæ¢å¥è¯è¯´å°±æ˜¯ï¼ŒrequestAnimationFrame çš„æ­¥ä¼è·Ÿç€ç³»ç»Ÿçš„åˆ·æ–°æ­¥ä¼èµ°ã€‚å®ƒèƒ½ä¿è¯å›è°ƒå‡½æ•°åœ¨å±å¹•æ¯ä¸€æ¬¡çš„åˆ·æ–°é—´éš”ä¸­åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·å°±ä¸ä¼šå¼•èµ·ä¸¢å¸§ç°è±¡ã€‚ å°† setTimeout æ›¿æ¢æˆ requestAnimationFrame: 123456789101112// å…¶ä»– ...window.requestAnimationFrame(function()&#123; for(let i = 0; i &lt; pageCount; i++)&#123; let li = document.createElement(&#x27;li&#x27;); li.innerText = curIndex + i + &#x27; : &#x27; + ~~(Math.random() * total) ul.appendChild(li) &#125; loop(curTotal - pageCount,curIndex + pageCount)&#125;)// ... ä½¿ç”¨ DocumentFragment DocumentFragmentï¼Œæ–‡æ¡£ç‰‡æ®µæ¥å£ï¼Œè¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰çˆ¶çº§æ–‡ä»¶çš„æœ€å°æ–‡æ¡£å¯¹è±¡ã€‚å®ƒè¢«ä½œä¸ºä¸€ä¸ªè½»é‡ç‰ˆçš„Documentä½¿ç”¨ï¼Œç”¨äºå­˜å‚¨å·²æ’å¥½ç‰ˆçš„æˆ–å°šæœªæ‰“ç†å¥½æ ¼å¼çš„XMLç‰‡æ®µã€‚æœ€å¤§çš„åŒºåˆ«æ˜¯å› ä¸ºDocumentFragmentä¸æ˜¯çœŸå®DOMæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„å˜åŒ–ä¸ä¼šè§¦å‘DOMæ ‘çš„ï¼ˆé‡æ–°æ¸²æŸ“) ï¼Œä¸”ä¸ä¼šå¯¼è‡´æ€§èƒ½ç­‰é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨document.createDocumentFragmentæ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„DocumentFragment ä»MDNçš„è¯´æ˜ä¸­ï¼Œæˆ‘ä»¬å¾—çŸ¥DocumentFragmentsæ˜¯DOMèŠ‚ç‚¹ï¼Œä½†å¹¶ä¸æ˜¯DOMæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥å°†å­å…ƒç´ æ’å…¥åˆ°æ–‡æ¡£ç‰‡æ®µæ—¶ä¸ä¼šå¼•èµ·é¡µé¢å›æµï¼ˆä»€ä¹ˆæ˜¯å›æµ? å›æµæ˜¯ä¼šå¯¼è‡´é¡µé¢é‡æ–°æ¸²æŸ“çš„ä¸€äº›å…ƒç´ ,ä»è€Œå½±å“æ€§èƒ½ï¼‰ã€‚ å½“appendå…ƒç´ åˆ°documentä¸­æ—¶ï¼Œè¢«appendè¿›å»çš„å…ƒç´ çš„æ ·å¼è¡¨çš„è®¡ç®—æ˜¯åŒæ­¥å‘ç”Ÿçš„ï¼Œæ­¤æ—¶è°ƒç”¨ getComputedStyle å¯ä»¥å¾—åˆ°æ ·å¼çš„è®¡ç®—å€¼ã€‚ è€Œappendå…ƒç´ åˆ° documentFragment ä¸­æ—¶ï¼Œæ˜¯ä¸ä¼šè®¡ç®—å…ƒç´ çš„æ ·å¼è¡¨ï¼Œæ‰€ä»¥documentFragment æ€§èƒ½æ›´ä¼˜ã€‚å½“ç„¶ç°åœ¨æµè§ˆå™¨çš„ä¼˜åŒ–å·²ç»åšçš„å¾ˆå¥½äº†ï¼Œ å½“appendå…ƒç´ åˆ°documentä¸­åï¼Œæ²¡æœ‰è®¿é—® getComputedStyle ä¹‹ç±»çš„æ–¹æ³•æ—¶ï¼Œç°ä»£æµè§ˆå™¨ä¹Ÿå¯ä»¥æŠŠæ ·å¼è¡¨çš„è®¡ç®—æ¨è¿Ÿåˆ°è„šæœ¬æ‰§è¡Œä¹‹åã€‚ 1234567891011121314// å…¶ä»– ...window.requestAnimationFrame(function()&#123; const fragment = document.createDocumentFragment() for(let i = 0; i &lt; pageCount; i++)&#123; let li = document.createElement(&#x27;li&#x27;); li.innerText = curIndex + i + &#x27; : &#x27; + ~~(Math.random() * total) fragment.appendChild(li) &#125; ul.appendChild(fragment) loop(curTotal - pageCount,curIndex + pageCount)&#125;)// ...","categories":[],"tags":[{"name":"JS","slug":"JS","permalink":"http://yoursite.com/tags/JS/"}]},{"title":"ESM/ESBuild","slug":"ESM-ESBuild","date":"2022-09-13T09:11:35.000Z","updated":"2022-09-16T08:40:53.050Z","comments":true,"path":"/post/ESM-ESBuild.html","link":"","permalink":"http://yoursite.com/post/ESM-ESBuild.html","excerpt":"ç»§ CommonJSã€AMDã€CMD å‡ ç§æ¨¡å—åŒ–è§„èŒƒç”±ç¤¾åŒºæå‡ºåï¼ŒES 2015ï¼ˆES6ï¼‰åœ¨è¯­è¨€å±‚é¢ä¸Šå®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œä¸”å®ç°ç®€å•ï¼Œå¯ä»¥æ›¿ä»£CommonJSå’ŒAMDè§„èŒƒï¼Œæˆä¸ºåœ¨æœåŠ¡å™¨å’Œæµè§ˆå™¨é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚","text":"ESModuleç»§ CommonJSã€AMDã€CMD å‡ ç§æ¨¡å—åŒ–è§„èŒƒç”±ç¤¾åŒºæå‡ºåï¼ŒES 2015ï¼ˆES6ï¼‰åœ¨è¯­è¨€å±‚é¢ä¸Šå®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œä¸”å®ç°ç®€å•ï¼Œå¯ä»¥æ›¿ä»£CommonJSå’ŒAMDè§„èŒƒï¼Œæˆä¸ºåœ¨æœåŠ¡å™¨å’Œæµè§ˆå™¨é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚ åœ¨æµè§ˆå™¨ä¸­é€šè¿‡ &lt;script type=&quot;module&quot;&gt; åŸç”Ÿæ”¯æŒ ESMã€‚ https://www.cnblogs.com/zhaojian-08/p/14385312.html å¯¼å…¥/å¯¼å‡º12345678// esm_index.jsexport const hello_world = 1export default function() &#123;&#125;&lt;script type=&quot;module&quot;&gt; import fn, &#123; hello_world &#125; from &#x27;./esm_index.js&#x27;&lt;/script&gt; åŠ¨æ€åŠ è½½123456789101112// dynamic-m.jsexport const dynamic_value = &#x27;åŠ¨æ€åŠ è½½&#x27;export default function() &#123; console.log(&#x27;default&#x27;)&#125;mport(&#x27;./dynamic-m.js&#x27;) .then(module =&gt; &#123; // module: &#123; default: fn, dynamic_value: &#x27;åŠ¨æ€åŠ è½½&#x27; &#125; console.log(&#x27;åŠ¨æ€&#x27;, module) &#125;) ESBuild https://esbuild.github.io/api/ ä»‹ç»: https://juejin.cn/post/6918927987056312327","categories":[],"tags":[{"name":"ESM ESModule ESBuild","slug":"ESM-ESModule-ESBuild","permalink":"http://yoursite.com/tags/ESM-ESModule-ESBuild/"}]},{"title":"æ·±å…¥æµ…å‡ºTypeScript","slug":"æ·±å…¥æµ…å‡ºTypeScript","date":"2022-09-09T02:35:36.000Z","updated":"2022-09-13T03:03:59.001Z","comments":true,"path":"/post/æ·±å…¥æµ…å‡ºTypeScript.html","link":"","permalink":"http://yoursite.com/post/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BATypeScript.html","excerpt":"TypeScript","text":"TypeScript.d.ts å’Œ declare æ˜¯å¹²å˜›ç”¨çš„å¦‚æœä¸€ä¸ªæ–‡ä»¶æœ‰æ‰©å±•å .d.tsï¼Œåˆ™è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå£°æ˜æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ¥å£°æ˜å…¨å±€çš„ç±»å‹å®šä¹‰å’Œæ¥å£ï¼Œæˆ–è€…æ˜¯å…¶å®ƒæ¨¡å—ã€‚æ¯”å¦‚ï¼š 1234567891011121314151617181920// global.d.ts// å£°æ˜æ¥å£declare interface Person &#123; name: string; age: number;&#125;// å£°æ˜ç±»å‹ (åˆ«å)declare type TName = string;// å£°æ˜æ¨¡å—declare module &#x27;*.css&#x27;;declare module &#x27;*.less&#x27;;declare module &#x27;*.png&#x27;;// æ‹“å±• window å±æ€§ï¼Œåœ¨ window å¯¹è±¡ä¸Šæ˜¾å¼è®¾ç½®å±æ€§declare interface Window &#123; MyNameSpace: any&#125; ä½†æ˜¯ä¹Ÿä¸æ˜¯è¯´åˆ›å»ºäº†.d.tsæ–‡ä»¶ï¼Œé‡Œé¢å£°æ˜çš„ä¸œè¥¿å°±èƒ½ç”Ÿæ•ˆäº†ï¼Œæ¯•ç«Ÿå½’æ ¹åˆ°åº•ä¹Ÿæ˜¯.tsæ–‡ä»¶ï¼Œéœ€è¦é¢„ç¼–è¯‘ï¼Œæ‰€ä»¥éœ€è¦åœ¨tsconfig.jsonæ–‡ä»¶é‡Œé¢çš„includeæ•°ç»„é‡Œé¢æ·»åŠ  global.d.ts æ–‡ä»¶ã€‚ 1&quot;include&quot;: [&quot;src/**/*.ts&quot;, &quot;src/**/*.d.ts&quot;, &quot;src/**/*.tsx&quot;, &quot;src/**/*.vue&quot;] .d.ts æ–‡ä»¶ä¸­çš„é¡¶çº§å£°æ˜å¿…é¡»ä»¥ â€œdeclareâ€ æˆ– â€œexportâ€ ä¿®é¥°ç¬¦å¼€å¤´ã€‚é€šè¿‡declareå£°æ˜çš„ç±»å‹æˆ–è€…å˜é‡æˆ–è€…æ¨¡å—ï¼Œåœ¨includeåŒ…å«çš„æ–‡ä»¶èŒƒå›´å†…ï¼Œéƒ½å¯ä»¥ç›´æ¥å¼•ç”¨ã€‚ 12345// .vue setup / .tsconst me: Person = &#123; name: &#x27;alex.cheng&#x27;, age: 18&#125; æ³¨æ„.d.tsæ–‡ä»¶é¡¶çº§å£°æ˜declareæœ€å¥½ä¸è¦è·ŸexportåŒçº§ä½¿ç”¨ï¼Œä¸ç„¶åœ¨å…¶ä»–tsæ–‡ä»¶å¼•ç”¨è¿™ä¸ª.d.tsçš„å†…å®¹çš„æ—¶å€™ï¼Œå°±éœ€è¦æ‰‹åŠ¨importå¯¼å…¥äº†ã€‚ 12345678// global.d.tsexport type TName = string;// è¿™ä¸ªæ—¶å€™ï¼Œå¤–éƒ¨ ts å°±æ— æ³•ç›´æ¥ä½¿ç”¨ Person äº†ï¼Œéœ€è¦å¼•å…¥ import &#123; Person &#125; from &#x27;../global.d.ts&#x27;export declare interface Person &#123; name: string; age: number;&#125; ç»™å¯¹è±¡åˆ†é…åŠ¨æ€ï¼ˆæœªçŸ¥ï¼‰å±æ€§1234567891011121314const o: &#123; [key: string]: any &#125; = &#123;&#125;// ä½¿ç”¨ ts å†…ç½®å·¥å…· Recordï¼Œæ•ˆæœåŒä¸Šconst o: Record&lt;string, any&gt; = &#123;&#125;interface IPerson extends Record&lt;string, any&gt; &#123; name: string; age?: number;&#125;const me1: IPerson = &#123; name: &#x27;alex&#x27;, hair: &#x27;black&#x27;&#125; interface å’Œ type æœ‰ä»€ä¹ˆåŒºåˆ« æ¥å£å’Œç±»å‹åˆ«åéƒ½å¯ä»¥ç”¨æ¥æè¿°å¯¹è±¡çš„å½¢çŠ¶æˆ–å‡½æ•°ç­¾åã€‚ ä¸æ¥å£ç±»å‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œç±»å‹åˆ«åå¯ä»¥ç”¨äºä¸€äº›å…¶ä»–ç±»å‹ï¼Œæ¯”å¦‚åŸå§‹ç±»å‹ã€è”åˆç±»å‹ï¼ˆ|ï¼‰å’Œå…ƒç»„ã€‚ æ¥å£å’Œç±»å‹åˆ«åéƒ½èƒ½å¤Ÿè¢«æ‰©å±•ï¼Œä½†è¯­æ³•æœ‰æ‰€ä¸åŒã€‚æ­¤å¤–ï¼Œæ¥å£å’Œç±»å‹åˆ«åä¸æ˜¯äº’æ–¥çš„ã€‚æ¥å£å¯ä»¥æ‰©å±•ç±»å‹åˆ«åï¼Œè€Œåè¿‡æ¥æ˜¯ä¸è¡Œçš„ã€‚ interface æ‰©å±•ï¼ˆæ¥å£ã€ç±»å‹ï¼‰ä½¿ç”¨ extends å…³é”®å­—ï¼Œç±»å‹åˆ«åæ‰©å±•ï¼ˆæ¥å£ã€ç±»å‹ï¼‰ä½¿ç”¨çš„æ˜¯ äº¤å‰ç±»å‹ï¼ˆ&amp;ï¼‰: 123456789101112131415// æ¥å£æ‰©å±•interface IPerson &#123; name: string;&#125;interface IMe extends IPerson &#123; age: number;&#125;// ç±»å‹æ‰©å±•type TPerson = &#123; name: string;&#125;type TMe = TPerson &amp; &#123; age: number;&#125; ç±»å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼å®ç°(implements)æ¥å£æˆ–ç±»å‹åˆ«åï¼Œä½†ç±»ä¸èƒ½å®ç°ä½¿ç”¨ç±»å‹åˆ«åå®šä¹‰çš„è”åˆç±»å‹ 12345678910111213// Error:type PartialPoint = &#123; x: number; &#125; | &#123; y: number; &#125;;class SomePartialPoint implements PartialPoint &#123; // ç±»åªèƒ½å®ç°å…·æœ‰é™æ€å·²çŸ¥æˆå‘˜çš„å¯¹è±¡ç±»å‹æˆ–å¯¹è±¡ç±»å‹çš„äº¤é›†ã€‚ts(2422) x = 1; y = 2;&#125;// Successtype PartialPoint = &#123; x: number; &#125; &amp; &#123; y: number; &#125;;class SomePartialPoint implements PartialPoint &#123; x = 1; y = 2;&#125; ä¸ç±»å‹åˆ«åä¸åŒï¼Œæ¥å£å¯ä»¥å®šä¹‰å¤šæ¬¡ï¼Œä¼šè¢«è‡ªåŠ¨åˆå¹¶ä¸ºå•ä¸ªæ¥å£ã€‚ 123456789101112interface IMerge &#123; a: 1;&#125;interface IMerge &#123; b: 2&#125;const ab: IMerge = &#123;&#125;; // ç±»å‹â€œ&#123;&#125;â€ç¼ºå°‘ç±»å‹â€œIMergeâ€ä¸­çš„ä»¥ä¸‹å±æ€§: a, bts(2739)// Error: æ ‡è¯†ç¬¦â€œTOneâ€é‡å¤ã€‚ts(2300)type TOne = string;type TOne = number; ç±»å‹ä¿æŠ¤ typeof instanceof in å‚è€ƒèµ„æ–™TS å­¦ä¹ æŒ‡å— â†©æ·±å…¥ç†è§£TypeScript â†©","categories":[],"tags":[{"name":"TypeScript TS","slug":"TypeScript-TS","permalink":"http://yoursite.com/tags/TypeScript-TS/"}]},{"title":"ç§»åŠ¨ç«¯å¼€å‘å®è·µ","slug":"app-h5","date":"2022-06-09T06:26:40.000Z","updated":"2022-06-09T06:44:26.042Z","comments":true,"path":"/post/app-h5.html","link":"","permalink":"http://yoursite.com/post/app-h5.html","excerpt":"React Native ã€H5ç§»åŠ¨ç«¯å¼€å‘å®è·µ","text":"WebViewç°åœ¨ Android Appå¤§å¤šåµŒå…¥äº† Android Webview ç»„ä»¶è¿›è¡Œ Hybrid å¼€å‘ï¼Œå®ƒå…·å¤‡å¼€å‘å‘¨æœŸçŸ­ã€çµæ´»æ€§å¥½çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒåŠ è½½é€Ÿåº¦æ…¢ &amp; æ¶ˆè€—æµé‡ã€‚å¼•èµ·ç¼ºç‚¹çš„ä¸»è¦åŸå› å¦‚ä¸‹ï¼š jsè§£ææ•ˆç‡ï¼Œä»¥åŠæ‰‹æœºç¡¬ä»¶è®¾å¤‡çš„æ€§èƒ½ é¡µé¢èµ„æºçš„ä¸‹è½½ï¼ˆå›¾ç‰‡ã€jsæ–‡ä»¶ã€cssæ–‡ä»¶ï¼‰ å‚è€ƒèµ„æ–™Android Webview H5 ç§’å¼€æ–¹æ¡ˆå®ç° â†©","categories":[],"tags":[{"name":"RN H5","slug":"RN-H5","permalink":"http://yoursite.com/tags/RN-H5/"}]},{"title":"å¦‚ä½•ç¼–å†™é«˜æ ‡å‡†çš„ JavaScript ä»£ç ","slug":"js-advice","date":"2022-03-31T02:12:23.000Z","updated":"2022-04-08T02:42:23.957Z","comments":true,"path":"/post/js-advice.html","link":"","permalink":"http://yoursite.com/post/js-advice.html","excerpt":"ä»£ç é‡å°‘ï¼Œè¿è¡Œé€Ÿåº¦ä¸ä¸€å®šå¿«ï¼›ä»£ç é‡å¤šï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿä¸ä¸€å®šæ…¢ã€‚","text":"æ¦‚è¿°ä½ æ˜¯å¦æ›¾ç»ä¸ºäº†æä¾›ä¸€ä¸ªç®€å•çš„åº”ç”¨è§£å†³æ–¹æ¡ˆè€Œå½»å¤œåœ°æŸ¥çœ‹æºä»£ç ï¼Ÿä½ æ˜¯å¦æ›¾ç»ä¸ºäº†ç†è§£æŸä¸ªæ¡†æ¶è€Œå†¥æ€è‹¦æƒ³ã€é˜…è§ˆç¾¤ä¹¦ï¼Ÿä½ æ˜¯å¦æ›¾ç»ä¸ºäº†æå‡0.1sçš„DOMæ€§èƒ½è€Œå¯¹å¤šç§å®ç°æ–¹æ¡ˆè¿›è¡Œä¸¥æ ¼æµ‹è¯•å’Œå¯¹æ¯”ï¼Ÿä½ æ˜¯å¦æ›¾ç»ä¸ºäº†é¿å…å…¼å®¹é—®é¢˜è€Œéå¯»é«˜æ‰‹å…±åŒâ€œè¯Šæ²»â€ï¼Ÿ è·Ÿæˆ‘ä¸€èµ·ï¼Œä¸“æ³¨é«˜è´¨é‡ JavaScript ä»£ç ï¼Œå°‘å‡º BugğŸ›ï¼Œæ—©ä¸‹ç­ ! æœŸæœ›ä¸ºè¯»è€…å¸¦æ¥å¦‚ä¸‹å¸®åŠ© ğŸ“šï¼š â‘ èƒ½å†™å‡ºç®€å•ã€æ¸…æ™°ã€é«˜æ•ˆçš„ä»£ç ã€‚ â‘ èƒ½æ­å»ºä¸€ä¸ªç¨³å®šã€å¥å£®ã€å¿«æ·çš„åº”ç”¨æ¡†æ¶ã€‚ â‘ èƒ½å›ç­”ä¸€ä¸ªå›°æ‰°å¾ˆå¤šäººçš„æŠ€æœ¯é—®é¢˜ã€‚ â‘ èƒ½ä¿®å¤ä¸€ä¸ªåº”ç”¨å¼€å‘ä¸­é‡åˆ°çš„å¤§çš„Bugã€‚ â‘ èƒ½éå¸¸ç†Ÿæ‚‰æŸä¸ªå¼€æºäº§å“ã€‚ â‘ èƒ½æå‡å®¢æˆ·ç«¯åº”ç”¨æ€§èƒ½ã€‚ JavaScript åŸºç¡€ä»£ç é‡å°‘ï¼Œè¿è¡Œé€Ÿåº¦ä¸ä¸€å®šå¿«ï¼›ä»£ç é‡å¤šï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿä¸ä¸€å®šæ…¢ã€‚ å‡å°‘å…¨å±€å˜é‡ å¤šä¸ªå…¨å±€å˜é‡éƒ½è¿½åŠ åœ¨ä¸€ä¸ªåç§°ç©ºé—´ä¸‹ï¼Œå°†æ˜¾è‘—é™ä½ä¸å…¶ä»–åº”ç”¨ç¨‹åºäº§ç”Ÿå†²çªçš„æ¦‚ç‡ 123const namespace = &#123;&#125;namespace.name = &#x27;my namespace&#x27; ä½¿ç”¨é—­åŒ…ä½“å°†ä¿¡æ¯éšè—ï¼Œå®ƒæ˜¯å¦ä¸€ç§æœ‰æ•ˆå‡å°‘â€œå…¨å±€æ±¡æŸ“â€çš„æ–¹æ³•ã€‚ 1234567const sayName = function() &#123; const name = &#x27;closure&#x27; return function() &#123; alert(name) &#125;&#125;() ä½œç”¨åŸŸæ§åˆ¶ç€å˜é‡ä¸å‚æ•°çš„å¯è§æ€§åŠç”Ÿå‘½å‘¨æœŸã€‚ JavaScriptæ”¯æŒå‡½æ•°ä½œç”¨åŸŸï¼Œå®šä¹‰åœ¨å‡½æ•°ä¸­çš„å‚æ•°å’Œå˜é‡åœ¨å‡½æ•°å¤–éƒ¨æ˜¯ä¸å¯è§çš„ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‡½æ•°ä¸­çš„ä»»ä½•ä½ç½®å®šä¹‰çš„å˜é‡åœ¨è¯¥å‡½æ•°ä¸­çš„ä»»ä½•åœ°æ–¹éƒ½å¯è§ã€‚å®ƒä¸ä»…å‡å°‘äº†åç§°å†²çªï¼Œå¹¶ä¸”æä¾›äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ã€‚ ES6 æ¨¡å—åŒ–ç¼–ç¨‹ä¸­æ¯ä¸ª js æ–‡ä»¶å†…éƒ¨å®šä¹‰çš„å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è·å–ã€‚å¦‚æœå¤–éƒ¨éœ€è¦æ¨¡å—å†…éƒ¨å˜é‡ï¼Œé€šè¿‡ export å¯¼å‡ºã€‚ 1234567891011&lt;script&gt; var windowA = &#x27;window a&#x27; console.log(window.windowA) // è¾“å‡º &#x27;window a&#x27;&lt;/script&gt;&lt;script type=&quot;module&quot;&gt; var moduleA = &#x27;module a&#x27; console.log(window.moduleA) // è¾“å‡º undefined&lt;/script&gt; è°¨æ…JSæ•°æ®ç±»å‹åœ¨è‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹æ—¶ï¼ŒJavaScriptä¸€èˆ¬éµå¾ªï¼šå¦‚æœæŸä¸ªç±»å‹çš„å€¼è¢«ç”¨äºéœ€è¦å…¶ä»–ç±»å‹çš„å€¼çš„ç¯å¢ƒä¸­ï¼ŒJavaScriptå°±è‡ªåŠ¨å°†è¿™ä¸ªå€¼è½¬æ¢æˆæ‰€éœ€è¦çš„ç±»å‹ã€‚ ç±»å‹è½¬æ¢æ…ç”¨JavaScriptç±»å‹è‡ªåŠ¨è½¬æ¢ï¼Œæ³¨æ„è‡ªåŠ¨è½¬æ¢è§„åˆ™: å¦‚æœæŠŠéç©ºå¯¹è±¡ç”¨åœ¨é€»è¾‘è¿ç®—ç¯å¢ƒä¸­ï¼Œåˆ™å¯¹è±¡è¢«è½¬æ¢ä¸ºtrueã€‚æ­¤æ—¶çš„å¯¹è±¡åŒ…æ‹¬æ‰€æœ‰ç±»å‹çš„å¯¹è±¡ï¼Œå³ä½¿æ˜¯å€¼ä¸ºfalseçš„åŒ…è£…å¯¹è±¡ä¹Ÿè¢«è½¬æ¢ä¸ºtrueã€‚ æœæŠŠå¯¹è±¡ç”¨åœ¨æ•°å€¼è¿ç®—ç¯å¢ƒä¸­ï¼Œåˆ™å¯¹è±¡ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚æœè½¬æ¢å¤±è´¥ï¼Œåˆ™è¿”å›å€¼ä¸ºNaNã€‚ å½“æ•°ç»„è¢«ç”¨åœ¨æ•°å€¼è¿ç®—ç¯å¢ƒä¸­æ—¶ï¼Œæ•°ç»„å°†æ ¹æ®åŒ…å«çš„å…ƒç´ æ¥å†³å®šè½¬æ¢çš„å€¼ã€‚å¦‚æœæ•°ç»„ä¸ºç©ºæ•°ç»„ï¼Œåˆ™è¢«è½¬æ¢ä¸ºæ•°å€¼0ã€‚å¦‚æœæ•°ç»„ä»…åŒ…å«ä¸€ä¸ªæ•°å­—å…ƒç´ ï¼Œåˆ™è¢«è½¬æ¢ä¸ºè¯¥æ•°å­—çš„æ•°å€¼ã€‚å¦‚æœæ•°ç»„åŒ…å«å¤šä¸ªå…ƒç´ ï¼Œæˆ–è€…ä»…åŒ…å«ä¸€ä¸ªéæ•°å­—å…ƒç´ ï¼Œåˆ™è¿”å›NaNã€‚ ğŸŒ° 123456789101112// å¯¹è±¡const obj = &#123;&#125;obj &amp;&amp; 1 &gt;&gt; 1obj + 1 &gt;&gt; &#x27;[object Object]1&#x27;obj.valueOf = function() &#123; return 99 &#125;obj + 1 &gt;&gt; 100// æ•°ç»„è‡ªåŠ¨è½¬æ¢è§„åˆ™+[] &gt;&gt; 0+[1] &gt;&gt; 1+[1,2] &gt;&gt; NaN ç±»å‹åˆ¤æ–­ typeofå¯¹äºä»»ä½•å˜é‡æ¥è¯´ï¼Œä½¿ç”¨typeofè¿ç®—ç¬¦æ€»æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ä»¥ä¸‹6ç§ç±»å‹ä¹‹ä¸€ï¼šâ‘ â€œnumberâ€â‘ â€œstringâ€â‘ â€œbooleanâ€â‘ â€œobjectâ€â‘ â€œfunctionâ€â‘ â€œundefinedâ€ ä»¤äººç–‘æƒ‘çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ typeof æ£€æµ‹nullå€¼æ—¶ï¼Œè¿”å›çš„æ˜¯â€œobjectâ€ï¼Œè€Œä¸æ˜¯â€œnullâ€ã€‚ 12345typeof null &gt;&gt; &#x27;object&#x27;typeof [] &gt;&gt; &#x27;object&#x27;typeof &#123;&#125; &gt;&gt; &#x27;object&#x27; instanceof instanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚ è¿™ä¸ªåœ¨åˆ¤æ–­å¯¹è±¡æ—¶å­˜åœ¨ä¸€äº›ä¸ç¡®å®šæ€§ï¼Œæ¥çœ‹ä¸‹ä¾‹å­ï¼š ğŸŒ° 123456function Person(name) &#123; this.name = name&#125;const p = new Person(&#x27;hello&#x27;)p instanceof Person &gt;&gt; truep instanceof Object &gt;&gt; true å†çœ‹ä¸€ä¸ªğŸŒ°: 123456789101112131415function Person(name) &#123; this.name = name&#125;function Child(name) &#123; this.name = name&#125;Child.prototype = Person.prototypeChild.prototype.constructor = Childconst p = new Child(&#x27;hello child&#x27;)p instanceof Person &gt;&gt; truep instanceof Object &gt;&gt; true å¦‚æœæ˜¯åˆ¤æ–­æ•°ç»„å‘¢? 1234567[] instanceof Array &gt;&gt; true[] instanceof Object &gt;&gt; true// å½“ç„¶è¿™ç§æ–¹å¼å­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Array.isArray() æ–¹æ³•æ¥åˆ¤æ–­Array.isArray([]) &gt;&gt; trueArray.isArray(&#123;&#125;) &gt;&gt; false ä»ä¸Šé¢ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨ instanceof æ¥åˆ¤æ–­æ—¶å­˜åœ¨ç§ç§ä¸ç¡®å®šæ€§ï¼Œåªè¦å‡ºç°åœ¨åŸå‹é“¾ä¸Šçš„å¯¹è±¡éƒ½ä¼šè¿”å› trueï¼Œä½¿ç”¨çš„æ—¶å€™è¿˜éœ€è¦ç€é‡æ³¨æ„ï¼ ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œæƒ³å¿…å¤§å®¶åº”è¯¥æƒ³èµ·æ¥äº†ï¼ Objectç±»æ˜¯æ‰€æœ‰å¯¹è±¡ç±»å‹çš„çš„çˆ¶ç±»! toString() æ–¹æ³• æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª toString() æ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªæ–‡æœ¬å€¼æ—¶ï¼Œæˆ–è€…ä¸€ä¸ªå¯¹è±¡ä»¥é¢„æœŸçš„å­—ç¬¦ä¸²æ–¹å¼å¼•ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒtoString() æ–¹æ³•è¢«æ¯ä¸ª Object å¯¹è±¡ç»§æ‰¿ã€‚å¦‚æœæ­¤æ–¹æ³•åœ¨è‡ªå®šä¹‰å¯¹è±¡ä¸­æœªè¢«è¦†ç›–ï¼ŒtoString() è¿”å› â€œ[object type]â€ï¼Œå…¶ä¸­ type æ˜¯å¯¹è±¡çš„ç±»å‹ã€‚ toString() æ–¹æ³•ï¼Œå®ƒå®šä¹‰åœ¨ Object çš„åŸå‹å¯¹è±¡ä¸Šï¼Œå¯¹è±¡åœ¨è°ƒç”¨æ—¶ä¼šè¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚ ä½¿ç”¨ toString() æ–¹æ³•æ£€æµ‹å¯¹è±¡ç±»å‹æ˜¯æœ€å®‰å…¨ã€æœ€å‡†ç¡®çš„ã€‚è°ƒç”¨toString()æ–¹æ³•æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡æ£€æµ‹å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«æ•°ç»„æ‰€ç‰¹æœ‰çš„æ ‡å¿—å­—ç¬¦å¯ä»¥ç¡®å®šå¯¹è±¡çš„ç±»å‹ã€‚ ä¸ºä»€ä¹ˆè¯´ toString æ–¹æ³•ç”¨æ¥æ£€æµ‹å¯¹è±¡ç±»å‹æ˜¯æœ€å®‰å…¨ã€æœ€å‡†ç¡®çš„ï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥çœ‹å§~ å…ˆçœ‹çœ‹åœ¨å¯¹è±¡ä¸Šç›´æ¥ä½¿ç”¨ toStringä¼šæ˜¯ä»€ä¹ˆç»“æœï¼š 1234567891011121314const obj = &#123; a: 1 &#125;const arr = [1, 2]obj.toString() &gt;&gt; &#x27;[object Object]&#x27;// å¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œåˆ™è¾“å‡ºå­—ç¬¦ä¸²arr.toString() &gt;&gt; &#x27;1,2&#x27;// å½“ç„¶æˆ‘ä»¬å¯ä»¥é‡å†™/è¦†ç›–åŸå‹é“¾ä¸Šçš„ toString æ–¹æ³•obj.toString = function() &#123; return &#x27;overwrite&#x27;&#125;obj.toString() &gt;&gt; &#x27;overwrite&#x27; æ—¢ç„¶ toString æ–¹æ³•å®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚æœå•ç‹¬è°ƒç”¨å®ƒï¼Œä¼šæ˜¯ä»€ä¹ˆç»“æœå‘¢? 1Object.prototype.toString() &gt;&gt; &#x27;[object Object]&#x27; å¦‚æœé€šè¿‡ call/apply æ–¹æ³•ï¼Œæ”¹å˜ toString æ–¹æ³•å†…éƒ¨çš„ this æ‰§è¡Œï¼Œåˆä¼šæ˜¯ä»€ä¹ˆç»“æœå‘¢? çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼Œæˆ‘ç›¸ä¿¡è¿™ç»å¯¹å¯ä»¥å®Œç¾ cover ä½é¡¹ç›®é‡Œé¢æ‰€æœ‰çš„ç±»å‹åˆ¤æ–­äº†ï¼æ‰€ä»¥è¯´å®ƒæ˜¯æœ€å®‰å…¨ã€æœ€å‡†ç¡®çš„ç±»å‹åˆ¤æ–­ï¼Œæ²¡æœ‰å¼‚è®®å§ğŸ˜ 12345678910111213141516171819202122Object.prototype.toString.call(&#123;&#125;) &gt;&gt; &#x27;[object Object]&#x27;Object.prototype.toString.call([]) &gt;&gt; &#x27;[object Array]&#x27;Object.prototype.toString.call(function()&#123;&#125;) &gt;&gt; &#x27;[object Function]&#x27;Object.prototype.toString.call(&#x27;&#x27;) &gt;&gt; &#x27;[object String]&#x27;Object.prototype.toString.call(1) &gt;&gt; &#x27;[object Number]&#x27;Object.prototype.toString.call(true) &gt;&gt; &#x27;[object Boolean]&#x27;Object.prototype.toString.call(null) &gt;&gt; &#x27;[object Null]&#x27;Object.prototype.toString.call(undefined) &gt;&gt; &#x27;[object Undefined]&#x27;Object.prototype.toString.call() &gt;&gt; &#x27;[object Undefined]&#x27;Object.prototype.toString.call(new Date()) &gt;&gt; &#x27;[object Date]&#x27;Object.prototype.toString.call(/at/) &gt;&gt; &#x27;[object RegExp]&#x27; é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Œæˆ‘ä»¬æ¥æ‰’ä¸€æ‰’å®ƒçš„åŸç†ï¼åœ¨ toString æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹å‡ ä¸ªæ“ä½œæ­¥éª¤: è·å–thisæŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼ã€‚ï¼ˆcall/apply æ”¹å˜ this æŒ‡å‘ï¼‰ è®¡ç®—å‡ºä¸‰ä¸ªå­—ç¬¦ä¸²â€[object â€œã€ ç¬¬ä¸€æ­¥çš„æ“ä½œç»“æœã€ ä»¥åŠ â€œ]â€ è¿æ¥åçš„æ–°å­—ç¬¦ä¸²ã€‚ è¿”å›ç¬¬äºŒæ­¥çš„æ“ä½œç»“æœï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼ &#39;[object Type]&#39; è¿™ç§æ ¼å¼å­—ç¬¦ä¸²ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹è±¡çš„[[Class]]å±æ€§æ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„ï¼Œå®ƒä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œæ‰€æœ‰çš„å¯¹è±¡(åŸç”Ÿå¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡)éƒ½æ‹¥æœ‰è¯¥å±æ€§ï¼Œä¸”ä¸èƒ½è¢«ä»»ä½•äººä¿®æ”¹ã€‚åœ¨è§„èŒƒä¸­ï¼Œ[[Class]]æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼šå†…éƒ¨å±æ€§æè¿°ã€‚ å¦‚æœè¦å•ç‹¬æˆ–è€…å¯¹è±¡çš„ [[Class]]ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš: 12const targetObj = []Object.prototype.toString.call(targetObj).slice(8, -1) &gt;&gt; &#x27;Array&#x27; æ—¢ç„¶å®ƒå¦‚æ­¤å¥½ç”¨ï¼Œéš¾é“å°±æ²¡æœ‰ç¼ºç‚¹å—ï¼Ÿ ç­”æ¡ˆæ˜¯å½“ç„¶æœ‰çš„ï¼Œæ¯•ç«Ÿå‡¡äº‹éƒ½ä¸å¯èƒ½é‚£ä¹ˆç»å¯¹çš„å˜›ï¼ é‚£ä¹ˆç¼ºç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¬¬ä¸€ï¼ŒtoString() ä¼šè¿›è¡Œè£…ç®±æ“ä½œï¼Œäº§ç”Ÿå¾ˆå¤šä¸´æ—¶å¯¹è±¡ã€‚ï¼ˆè£…ç®±å°±æ˜¯å°†åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨å¼•ç”¨ç±»ä¸Šçš„æ–¹æ³•ï¼‰ 12345// ä½ è‚¯å®šä¸èƒ½è¿™æ ·ç”¨1.toString() &gt;&gt; SyntaxError: Invalid or unexpected token// ä½ å¿…é¡»è¿™æ ·ç”¨(1).toString() &gt;&gt; &#x27;1&#x27; ç¬¬äºŒï¼Œæ— æ³•åŒºåˆ†è‡ªå®šä¹‰å¯¹è±¡ç±»å‹ï¼Œç”¨æ¥åˆ¤æ–­è¿™ç±»å¯¹è±¡æ—¶ï¼Œè¿”å›çš„éƒ½æ˜¯Objectï¼Œè¿™æ ·æˆ‘ä»¬å°±éœ€è¦é€šè¿‡ instanceof æ¥åˆ¤æ–­äº†ã€‚ 1234function Person()&#123;&#125;const p = new Person()Object.prototype.toString.call(p) &gt;&gt; &#x27;[object Object]&#x27; å­—ç¬¦ä¸²JavaScriptè§£é‡Šå™¨å¼ºåˆ¶çº¦å®šå­—ç¬¦ä¸²åœ¨å †åŒºå­˜å‚¨çš„æ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaScriptè§£é‡Šå™¨å¼ºåˆ¶çº¦å®šå­—ç¬¦ä¸²åœ¨å †åŒºå­˜å‚¨çš„æ•°æ®æ˜¯ä¸å¯å˜çš„ã€‚ å‚è€ƒèµ„æ–™å‚è€ƒèµ„æ–™ â†©å‚è€ƒèµ„æ–™2 â†©","categories":[],"tags":[{"name":"JavaScript, ES6","slug":"JavaScript-ES6","permalink":"http://yoursite.com/tags/JavaScript-ES6/"}]},{"title":"React Hooks","slug":"react-hooks","date":"2022-03-26T10:41:01.000Z","updated":"2022-09-16T08:22:44.579Z","comments":true,"path":"/post/react-hooks.html","link":"","permalink":"http://yoursite.com/post/react-hooks.html","excerpt":"ä»€ä¹ˆæ˜¯React Hooksï¼Œä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿå¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨React Hooksï¼Ÿå¦‚ä½•è‡ªå®šä¹‰ Hooks ï¼Ÿå¦‚ä½•é€šè¿‡ Hooks åšæ€§èƒ½ä¼˜åŒ–ï¼Ÿ","text":"Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚ åŠ¨æœºHook è§„åˆ™ åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚ï¼ˆæˆ–ï¼šåœ¨è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨å…¶ä»– Hookï¼‰ ä½¿ç”¨ useCallbackã€useMemoã€memo åšæ€§èƒ½ä¼˜åŒ–å°½å¯èƒ½çš„ä¿è¯ç»„ä»¶ä¸å»å‘ç”Ÿå˜åŒ–ï¼Œå‘ç”Ÿå˜åŒ–çš„å› ç´ æœ‰ï¼šstateã€propsã€contextã€‚ é‚£ä¹ˆ React æ˜¯å¦‚ä½•æ¯”è¾ƒè¿™ä¸‰è€…çš„å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ å†…å­˜åœ°å€ã€‚ æ¯”å¦‚è¯´ï¼Œå¯¹æ¯”ä¸€ä¸ª functionï¼Œå¯¹æ¯”çš„å°±æ˜¯è¿™ä¸ªå‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œé€šè¿‡åœ°å€çš„åˆ¤æ–­ï¼Œä»è€Œåˆ¤æ–­ props æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ã€‚ React.memo https://react.docschina.org/docs/hooks-faq.html#how-do-i-implement-shouldcomponentupdate React.memo åŒ…è£¹ä¸€ä¸ªç»„ä»¶ï¼Œæ¥å¯¹å®ƒçš„ props è¿›è¡Œæµ…æ¯”è¾ƒã€‚ç­‰æ•ˆäº PureComponentï¼Œä½†å®ƒåªæ¯”è¾ƒ propsã€‚ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°æ¥æ¯”è¾ƒæ–°æ—§ propsã€‚å¦‚æœå‡½æ•°è¿”å› trueï¼Œå°±ä¼šè·³è¿‡æ›´æ–°ã€‚ï¼‰ 123456789101112131415161718192021222324// ä¸ä½¿ç”¨ memoï¼Œæ¯ä¸€æ¬¡ setCountï¼Œéƒ½ä¼šé€ æˆ Child ç»„ä»¶é‡æ–° renderconst Child = () =&gt; &#123; console.log(&#x27;Child&#x27;) return ( &lt;&gt;Child component&lt;/&gt; )&#125;const Demo = () =&gt; &#123; const [count, setCount] = useState(0) return ( &lt;&gt; &lt;button onClick=&#123;() =&gt; setCount(count =&gt; count + 1)&#125;&gt;+&lt;/button&gt; &lt;Child /&gt; &lt;/&gt; )&#125;// é€šè¿‡ memo åŒ…è£¹åï¼ŒChild ç»„ä»¶ä¸ä¼šå†é‡æ–° renderäº†ã€‚const Child = memo(() =&gt; &#123; console.log(&#x27;Child&#x27;) return ( &lt;&gt;Child component&lt;/&gt; )&#125;) å½“ memo æ„ŸçŸ¥ props æ²¡æœ‰å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¸ä¼šé‡æ–° render ç»„ä»¶ã€‚å¦‚æœä¼ å…¥ count è¿›æ¥ï¼ŒChildç»„ä»¶å°±ä¼šé‡æ–° renderã€‚ æ€»ç»“ï¼š å¦‚æœæˆ‘ä»¬å°† setCount å½“åš prop ä¼ å…¥è¿›æ¥ï¼ŒChild ä¸ä¼šé‡æ–°renderï¼ˆå› ä¸º setCount åœ¨å†…å­˜ä¸­çš„åœ°å€æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼‰ å¦‚æœä¼ å…¥æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ–¹æ³• (fn)è¿›æ¥ï¼ŒChildä¼šé‡æ–° renderï¼Œå› ä¸º Demo ç»„ä»¶æ¯æ¬¡æ›´æ–° count åï¼Œé‡æ–°ç”Ÿæˆäº† fn å‡½æ•°ã€‚ åªæ˜¯ä¼ äº†ä¸ª fn ï¼Œä¸æƒ³è®© Child ç»„ä»¶æ›´æ–°æ€ä¹ˆåŠï¼Ÿé‚£å°±è¦ç”¨åˆ° useCallback é’©å­äº† useMemoæŠŠâ€œåˆ›å»ºâ€å‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useMemoï¼Œå®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®—ã€‚ 1234// åªæœ‰å½“ count å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°è®¡ç®—const computedCount = useMemo(() =&gt; &#123; return count * 2&#125;, [count]) useMemo ä¹Ÿå…è®¸ä½ è·³è¿‡ä¸€æ¬¡å­èŠ‚ç‚¹çš„æ˜‚è´µçš„é‡æ–°æ¸²æŸ“ï¼Œæ¯”å¦‚ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œéœ€è¦ä¸€æ¬¡å¤§é‡çš„è®¡ç®—ï¼Œåç»­å°±ä¸ä¼šå†æ”¹å˜äº†ï¼š 123456789101112function Parent(&#123; a, b &#125;) &#123; // Only re-rendered if `a` changes: const child1 = useMemo(() =&gt; &lt;Child1 a=&#123;a&#125; /&gt;, [a]); // Only re-rendered if `b` changes: const child2 = useMemo(() =&gt; &lt;Child2 b=&#123;b&#125; /&gt;, [b]); return ( &lt;&gt; &#123;child1&#125; &#123;child2&#125; &lt;/&gt; )&#125; useCallbackæŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useCallbackï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ã€‚ ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå³ä½¿æˆ‘ä»¬ç”¨ memo åŒ…è£¹äº†ç»„ä»¶ï¼Œå› ä¸º setCount æ¯æ¬¡ä¼šå¼•èµ· Demo ç»„ä»¶é‡æ–° renderï¼Œç”Ÿæˆäº†æ–°çš„ fn å‡½æ•°(å†…å­˜åœ°å€å‘ç”Ÿäº†å˜åŒ–)ï¼Œå¯¼è‡´ Child ä¹Ÿä¼šé‡æ–° renderã€‚ 123456789101112131415161718192021interface IChild &#123; fn: React.Dispatch&lt;React.SetStateAction&lt;number&gt;&gt;&#125;const Child = memo((props: IChild) =&gt; &#123; console.log(&#x27;Child&#x27;) return ( &lt;&gt;Child component&lt;/&gt; )&#125;)const Demo = () =&gt; &#123; const [count, setCount] = useState(0) const fn = () =&gt; console.log(&#x27;is fn&#x27;) return ( &lt;&gt; &lt;button onClick=&#123;() =&gt; setCount(count =&gt; count + 1)&#125;&gt;+&lt;/button&gt; &lt;Child fn=&#123;fn&#125; /&gt; &lt;/&gt; )&#125; æˆ‘ä»¬ä¸æƒ³è®© fn å‡½æ•°çš„ å†…å­˜åœ°å€ å‘ç”Ÿå˜åŒ–ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿä½¿ç”¨ useCallback é’©å­å°†å…¶åŒ…è£¹èµ·æ¥å³å¯ã€‚ æ³¨æ„ï¼šuseMemo ä¹Ÿå¯ä»¥è¿™æ ·ç”¨ï¼Œç¼“å­˜ fnï¼Œä»è€Œä½¿å¾— Child ç»„ä»¶ä¸ä¼šé‡å¤ renderã€‚ 1234567// çœç•¥...const fn = useCallback(() =&gt; &#123; console.log(&#x27;is fn&#x27;)&#125;, [])// çœç•¥... è¿™æ · fn å‡½æ•°å°±æ˜¯ä¸€ä¸ªç¼“å­˜å‡½æ•°äº†ï¼Œå³ä½¿ count ä¸åœçš„å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¸ä¼šé€ æˆ Child ç»„ä»¶é‡å¤ renderã€‚ æ€»ç»“: å½“ Demo ç»„ä»¶å†…éƒ¨ state å‘ç”Ÿäº†æ”¹å˜å¼•èµ· Demo å’Œ Child ç»„ä»¶é‡æ–° render å¹¶ä¸” Child ç»„ä»¶æ¥å—äº†ä¸€ä¸ªæ¥è‡ª Demo ç»„ä»¶è‡ªå®šä¹‰çš„æ–¹æ³•ï¼ˆfnï¼‰ å¦‚æœä¸å¸Œæœ› Child ç»„ä»¶é‡æ–° renderï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨ useCallback é’©å­å°†è‡ªå®šä¹‰æ–¹æ³• fn åŒ…è£¹èµ·æ¥ å› ä¸º Child ç»„ä»¶ props é‡Œé¢çš„ fn å’Œ useCallback è¿”å›çš„ fn æŒ‡å‘çš„æ˜¯å†…å­˜ä¸­çš„åŒä¸€ä¸ªåœ°å€ï¼Œé‚£ä¹ˆ Child ç»„ä»¶å°±ä¸ä¼šæ›´æ–° useCallback è¿”å›æ–°å‡½æ•°çš„æ¡ä»¶æ˜¯ï¼šä¾èµ–é¡¹ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰å‘ç”Ÿäº†æ”¹å˜ã€‚ å¦‚æœè¯´æˆ‘ä»¬çš„ Child ç»„ä»¶ï¼Œæœ¬èº«å°±æ˜¯éœ€è¦æ ¹æ® count å˜åŒ–è€Œå˜åŒ–ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åŠ è¿™ä¸ªç¼“å­˜ APIäº†ï¼Œåè€Œå¢åŠ å…¶è®¡ç®—è´Ÿæ‹…ã€‚ è®¾è®¡ç»„ä»¶ä¸è¦ä¸ºäº†ä½¿ç”¨é’©å­ï¼Œè¿‡æ¸¡çš„ä½¿ç”¨é’©å­ï¼Œå¥½çš„é¡µé¢è®¾è®¡ï¼Œä¹Ÿè®¸ç”¨ä¸ä¸Šè¿™äº›é’©å­ã€‚ æŠŠä¸å˜çš„ç»„ä»¶å’Œå˜åŒ–çš„ç»„ä»¶æŠ½ç¦»å‡ºæ¥ï¼ æ¯”å¦‚å¯ä»¥æŠŠ count ç›¸å…³éƒ¨åˆ†æŠ½ç¦»æˆä¸€ä¸ª Count ç»„ä»¶ï¼Œä½¿å…¶å’Œ Child ç»„ä»¶åŒå±‚çº§æ’åˆ—ï¼ŒCount ç»„ä»¶å’Œ Child ç»„ä»¶åˆ†å¼€äº†ï¼Œä¹Ÿä¸ä¼šå¼•èµ· Child ç»„ä»¶åšå¤šä½™çš„ renderã€‚ 12&lt;Count /&gt;&lt;Child prop=&#123;fn&#125; /&gt; æˆ–è€…æ˜¯é€šè¿‡ props.children æ¸²æŸ“ Childï¼Œä¹Ÿä¸ä¼šé€ æˆ Child é‡æ–° renderã€‚ 12345678910111213141516171819202122const Count = (props: any) =&gt; &#123; const [count, setCount] = useState(0) return ( &lt;&gt; &lt;button onClick=&#123;() =&gt; setCount(count =&gt; count + 1)&#125;&gt;+&lt;/button&gt; &#123;/* children ä¸ä¼šé‡æ–° render */&#125; &#123;props.children&#125; &lt;/&gt; )&#125;const Demo = () =&gt; &#123; // fn æ°¸è¿œä¸ä¼šå˜åŒ– const fn = () =&gt; &#123;&#125; return ( &lt;&gt; &lt;Count&gt; &lt;Child fn=&#123;fn&#125; /&gt; &lt;/Count&gt; &lt;/&gt; )&#125; useRef / createRef è®¿é—® DOM èŠ‚ç‚¹ 123456const inputEle = useRef(null)const inputEle = React.createRef()inputEle.current.focus() æµ‹é‡ DOMèŠ‚ç‚¹ï¼Ÿ1234567891011121314151617const getHeight = useMemo(() =&gt; &#123; return (node: HTMLObjectElement) =&gt; &#123; if (node) &#123; setHeight(node.getBoundingClientRect().height) &#125; &#125;&#125;, [])// æˆ–è€…const getHeight = useCallback((node: HTMLObjectElement) =&gt; &#123; if (node) &#123; setHeight(node.getBoundingClientRect().height) &#125;&#125;, []) å°† ref é€»è¾‘æŠ½ç¦»æˆä¸€ä¸ª Hook 1234567891011121314151617181920// hookconst useClientRect = () =&gt; &#123; const [rect, setRect] = useState(null) const ref = useCallback(node =&gt; &#123; if (node) &#123; setRect(node.getBoundingClientRect()) &#125; &#125;, []) return [rect, ref]&#125;// ä½¿ç”¨const [rect, ref] = useClientRect()&lt;h1 ref=&#123;ref&#125;&gt;æ˜¯ H1 æ ‡ç­¾ &#123;count&#125;&lt;/h1&gt;&#123; rect &amp;&amp; &lt;span&gt;&#123;rect.height&#125;&lt;/span&gt;&#125; React.forwardRef React.forwardRef ä¼šåˆ›å»ºä¸€ä¸ªReactç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æ¥å—çš„ ref å±æ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚ 123456789const FancyInput = forwardRef((props, ref) =&gt; ( &lt;input ref=&#123;inputRef&#125; &#123;...props&#125; /&gt;))// è¿™æ ·å¯ä»¥æ‹¿åˆ° input å…ƒç´ äº†const inputEle = React.createRef()&lt;FancyInput ref=&#123;inputEle&#125; /&gt; useImperativeHandle useImperativeHandle å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ ref æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚ 12345678910111213141516171819202122232425const FancyInput = forwardRef((props, ref) =&gt; &#123; const inputRef = useRef(); useImperativeHandle(ref, () =&gt; (&#123; focus: () =&gt; &#123; inputRef.current.focus(); &#125;, alert () &#123; alert(1) &#125; &#125;)); return &lt;input ref=&#123;inputRef&#125; &#123;...props&#125; /&gt;;&#125;)const inputEle = React.createRef()&lt;FancyInput ref=&#123;inputEle&#125; /&gt;// é€šè¿‡ inputEle è·å–åˆ° useImperativeHandle å®šä¹‰çš„æ–¹æ³•inputEle.current.focus()inputEle.current.alert() å‚è€ƒèµ„æ–™ahooks å®˜ç½‘ â†©","categories":[],"tags":[{"name":"Reactï¼ŒHooks","slug":"Reactï¼ŒHooks","permalink":"http://yoursite.com/tags/React%EF%BC%8CHooks/"}]},{"title":"Hello_AlexCc","slug":"first-article","date":"2019-07-29T15:37:50.000Z","updated":"2022-04-07T10:04:40.419Z","comments":true,"path":"/post/first-article.html","link":"","permalink":"http://yoursite.com/post/first-article.html","excerpt":"First Article","text":"What This is my first Blog. No.212345if (true) &#123; console.log(&quot;Hello_AlexCc!&quot;)&#125;return &quot;ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾&quot;","categories":[],"tags":[{"name":"One","slug":"One","permalink":"http://yoursite.com/tags/One/"}]}],"categories":[],"tags":[{"name":"JS","slug":"JS","permalink":"http://yoursite.com/tags/JS/"},{"name":"ESM ESModule ESBuild","slug":"ESM-ESModule-ESBuild","permalink":"http://yoursite.com/tags/ESM-ESModule-ESBuild/"},{"name":"TypeScript TS","slug":"TypeScript-TS","permalink":"http://yoursite.com/tags/TypeScript-TS/"},{"name":"RN H5","slug":"RN-H5","permalink":"http://yoursite.com/tags/RN-H5/"},{"name":"JavaScript, ES6","slug":"JavaScript-ES6","permalink":"http://yoursite.com/tags/JavaScript-ES6/"},{"name":"Reactï¼ŒHooks","slug":"Reactï¼ŒHooks","permalink":"http://yoursite.com/tags/React%EF%BC%8CHooks/"},{"name":"One","slug":"One","permalink":"http://yoursite.com/tags/One/"}]}